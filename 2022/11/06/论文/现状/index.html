<!DOCTYPE HTML>
<html>
<head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="black">
  <meta name="google-site-verification" content="" />
  <meta name="referrer" content="unsafe-url">
  
  <title>数据包现状</title>
  <meta name="author" content="Peirsist">
  <meta name="description" content="2019 数据包过滤规则匹配与并行化技术研究
主要介绍的哈希线性查找和分层树查找。没有介绍传统的软件和硬件，具体内容看论文。
数据包分类功能是由一个包含有一系列规则的数据包分类器完成，每一类数据包至少遵循其中的一个规则。这些规则是依据数据包头的内容把数据包分为不同的类流，以进行不同的处理，即丢弃">
  
  
  <meta property="og:title" content="数据包现状"/>
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
  <meta property="og:site_name" content="EEWIKI"/>
  <link href="/apple-touch-icon-precomposed.png" sizes="180x180" rel="apple-touch-icon-precomposed">
  <link rel="alternate" href="/atom.xml" title="EEWIKI" type="application/atom+xml">
  <link rel="stylesheet" href="/css/m.min.css">
  <link rel="icon" type="image/x-icon" href="/favicon.ico">
  <script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js?config=TeX-MML-AM_CHTML" async></script>

<meta name="generator" content="Hexo 6.3.0"></head>

<body>
  <a id="top"></a>
  <div id="main">
    <div class="main-ctnr">
      <div class="behind">
  <a href="/" class="back black-color">
    <svg class="i-close" viewBox="0 0 32 32" width="22" height="22" fill="none" stroke="currentcolor" stroke-linecap="round" stroke-linejoin="round" stroke-width="3">
        <path d="M2 30 L30 2 M30 30 L2 2"></path>
    </svg>
  </a>
  
</div>


  <article class="standard post">
    <div class="title">
      
  
    <h1 class="page-title center">
        数据包现状
    </h1>
  


    </div>
    <div class="meta center">
      <time datetime="2022-11-06T07:54:41.000Z" itemprop="datePublished">
  <svg class="i-calendar" viewBox="0 0 32 32" width="16" height="16" fill="none" stroke="currentcolor" stroke-linecap="round" stroke-linejoin="round" stroke-width="2">
    <path d="M2 6 L2 30 30 30 30 6 Z M2 15 L30 15 M7 3 L7 9 M13 3 L13 9 M19 3 L19 9 M25 3 L25 9"></path>
  </svg>
  &nbsp;
  2022-11-06
</time>


    
    &nbsp;
    <svg class="i-tag" viewBox="0 0 32 32" width="16" height="16" fill="none" stroke="currentcolor" stroke-linecap="round" stroke-linejoin="round" stroke-width="2">
      <circle cx="24" cy="8" r="2"></circle>
      <path d="M2 18 L18 2 30 2 30 14 14 30 Z"></path>
    </svg>
    &nbsp;
    <a href="/categories/论文/">论文</a>





    </div>
    <hr>
    
      <ol class="toc"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%95%B0%E6%8D%AE%E5%8C%85%E8%BF%87%E6%BB%A4%E8%A7%84%E5%88%99%E5%8C%B9%E9%85%8D%E4%B8%8E%E5%B9%B6%E8%A1%8C%E5%8C%96%E6%8A%80%E6%9C%AF%E7%A0%94%E7%A9%B6"><span class="toc-text">2019 数据包过滤规则匹配与并行化技术研究</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%9F%BA%E4%BA%8E-gpu-%E5%8A%A0%E9%80%9F%E7%9A%84%E5%8C%85%E5%88%86%E7%B1%BB%E7%AE%97%E6%B3%95%E7%A0%94%E7%A9%B6%E4%B8%8E%E5%AE%9E%E7%8E%B0"><span class="toc-text">2020-基于 GPU 加速的包分类算法研究与实现</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%8C%87%E6%A0%87"><span class="toc-text">指标</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E8%A7%84%E5%88%99%E9%9B%86%E5%AD%97%E6%AE%B5%E7%9A%84%E7%BB%B4%E5%BA%A6%E5%88%92%E5%88%86"><span class="toc-text">规则集字段的维度划分</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%BC%82%E6%9E%84%E5%B9%B3%E5%8F%B0%E7%BC%96%E7%A8%8B%E6%A8%A1%E5%9E%8B-opencl"><span class="toc-text">异构平台编程模型-OpenCL</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%9F%BA%E4%BA%8E-fpga-%E7%9A%84%E5%8C%85%E5%88%86%E7%B1%BB%E7%AE%97%E6%B3%95%E7%9A%84%E8%AE%BE%E8%AE%A1%E4%B8%8E%E5%AE%9E%E7%8E%B0"><span class="toc-text">2015 基于 FPGA 的包分类算法的设计与实现</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%9F%BA%E4%BA%8E%E8%A7%84%E5%88%99%E8%81%9A%E9%9B%86%E7%89%B9%E5%BE%81%E7%9A%84%E9%AB%98%E9%80%9F%E5%88%86%E7%B1%BB%E7%AE%97%E6%B3%95"><span class="toc-text">2016 基于规则聚集特征的高速分类算法</span></a></li></ol>
    
    <div class="picture-container">
      
    </div>
    <h2 id="数据包过滤规则匹配与并行化技术研究">2019 数据包过滤规则匹配与并行化技术研究</h2>
<p><mark>主要介绍的哈希线性查找和分层树查找。没有介绍传统的软件和硬件</mark>，具体内容看论文。</p>
<p>数据包分类功能是由一个包含有一系列规则的数据包分类器完成，每一类数据包至少遵循其中的一个规则。这些规则是依据数据包头的内容把数据包分为不同的类流，以进行不同的处理，即丢弃、转发。</p>
<ol type="1">
<li>线性查找</li>
<li>分层树查找</li>
</ol>
<h2 id="基于-gpu-加速的包分类算法研究与实现">2020-基于 GPU 加速的包分类算法研究与实现</h2>
<p>OpenFlow 作为数据层面转发数据包依据的主流协议，它打破了传统网络分层的概念，所有需要匹配的字段都包括在一张流表里面，实现了协议的扁平化。</p>
<p>从上面目前 OpenFlow 包分类算法面临的字段匹配需求来看，主要问题在于原有的基于纯 CPU 设计的包分类算法在包分类规模以及字段数量快速增加的情况下，该类算法的性能会大大降低，大部分原因是由于 CPU 的计算能力还不足导致的。从而我们可以考虑寻求计算能力更加强大的硬件来结合 CPU 构建异构包分类架构。其中可选的硬件主要有 TCAM、 FPGA、 GPU。</p>
<p>包分类是一种在预定义规则集中匹配数据包从而根据规则定义的动作处理数据包的方法， 其中输入包可以匹配一个或多个规则， 我们选择具有最高优先级的规则定义的动作处理输入数据包[5]。</p>
<ol type="1">
<li>软件
<ol type="1">
<li>Tries
<ol type="1">
<li>Hierarch Tries， Grid-of-tries [6-8]</li>
</ol></li>
<li>X-tree
<ol type="1">
<li>布谷鸟过滤器</li>
</ol></li>
<li>分割
<ol type="1">
<li>Hicuts，HyperCuts</li>
</ol></li>
<li>哈希表
<ol type="1">
<li>TSS...</li>
</ol></li>
<li>维度降解
<ol type="1">
<li>RFC</li>
</ol></li>
</ol></li>
<li>硬件
<ol type="1">
<li>TCAM
<ol type="1">
<li>三态内容地址寄存器） 设计了一系列的包分类算法， 该系列算法具有的很高并行查找能力和极高包类吞吐量[4,15-17]</li>
<li>TCAM 有高功耗高成本等问题</li>
</ol></li>
<li>FPGA
<ol type="1">
<li>利用 FPGA 的流水线架构， 能够在大规模规则集上取得很高的吞吐量， 然而算法的处理延迟很高[18-23]</li>
</ol></li>
<li>GPU
<ol type="1">
<li>利用 GPU 的并行计算能力， 基于GPU 的计算特点来设计包分类算法， 该类算法能很好的加速数据包的匹配， 有效的缩短数据包处理时间[4,23-28]。</li>
<li>在国内， 也有很多学者基于 TCAM， FPGA，GPU 研究了很多优秀的包分类算法[29-31]，</li>
</ol></li>
</ol></li>
</ol>
<h2 id="指标">指标</h2>
<p>对于任何一个算法都有其性能评价标准， 而包分类算法主要包括下面几个性能指标： 1. <strong>数据包的匹配速度</strong>： 包分类算法就是为数据包的快速匹配所设计的，所以数据包的匹配速度作为包分类算法的核心评价指标， 关乎着包分类算法的设计意义。 2. <strong>算法内存占用</strong>： 一个好的算法设计， 不光要考虑到算法的运行速度，该算法的内存占用， 即空间复杂度也是需要考虑的， 优秀的算法都是在一定程度上优化空间复杂度， 以降低该算法的硬件成本， 所以算法的内存占用也是衡量包分类算法性能的重要指标之一。 3. <strong>预处理时间</strong>： 对于包分类算法， 在设计过程中会涉及一些数据结构，而<strong>包分类算法的预处理时间基本上都耗费在数据结构的初始化过程中</strong>， 过长预处理时间会降低该包分类算法的整体效率， 由此可见尽量减少预处理时间是至关重要的。 4. <strong>算法更新时间</strong>： 在包分类算法中， 需要考虑到<strong>规则集的动态更新过程，需要保证规则集动态更新不能过长</strong>， 不然会拉低整个匹配速度， 降低了算法匹配 的效率。 5. <strong>算法的可扩展性</strong>： 包分类算法涉及到网络中的数据包和规则集， 而随着互联网的发展， 网络中的数据包和规则集的架构会发生变化， 比如规则集的数量增多， 规则集中的字段增加， 这些都是在设计包分类算法的过程中需要考虑的，尤其是在 SDN 网络兴起后， 规则集的规模和字段数量急剧增加， 包分类算法的可扩展性变得越来越关键。</p>
<p>然而以上五个包分类算法的性能评价指标之间难以同时满足， 达到最优化，从而 <strong>现实中设计包分类算法可以针对一些场景的特点， 适当提高某些性能指标的性能， 牺牲其它指标的性能来满足一些特定场景需求。</strong></p>
<p><strong>如果能够对规则集进行预处理归类， 在查找匹配的过程中只在某个类别的规则集中进行查找， 将会避免遍历整个规则集， 从而提高查找效率</strong>，（<mark><strong>划重点，所有方法都是这一思想</strong></mark>） 例如上文提到的元组空间查找算法（TSS） 就依据字段之间组合的长度的不同把规则集进行元组划分， 在查找匹配的过程中只在某个元组中进行查找， 大大提高了查找匹配的速度。</p>
<p>在本文中将<strong>利用网络中存在的局部流现象</strong>， 并结合规则集的优先级， <strong>把规则集拆分为主规则集（Major-Table） 和次规则集（Rarely-Table） 两部分</strong>， 查找匹配的时候优先在主规则集中查找， 若查找不到再去次规则集中进行查找， 下文将用 Major-Table 和Rarely-Table 来分别代替主规则集和次规则集。 为了更快的查找匹配， <strong>对于主规则集和次规则集划分比例将依据局部流现象存在的比例进行划分</strong>。</p>
<p>有大量的研究表明， 在现实网络中存在着这样一种现象： 在网络中某段时间内的流往往属于同一段流， 而这部分分流占据了网络中的大部分流量， 此部分分流被一些研究人员称之为<strong>大象流</strong>， 而那部分占据网络中的少部分流量的分流则被称为<strong>老鼠流</strong>。并且有许多研究人员针对大象流和老鼠流的识别做了大量的研究工 作,同时应用于像数据中心这样的大数据流环境当中[44-45]。 研究试验后， 给出了具体的数据信息如下： <strong>有大约 9% 的流量占据了网络中 86.7% 的数据包， 而且该部分流量的字节数占据了总字节数的 90.5%[46]</strong> （<mark>什么意思不懂</mark>）。 总结来说， <strong>网络流的局部现象表现为： 网络中某一个连接的数据包往往会批量集中的到达， 当一个数据包到达时， 往往下一个数据包也同属于一个连接</strong>[47]。 图 3.1 为网络局部流示意图：</p>
<p>一般规则集都是存储在交换设备中， 由一条条的规则项组成， 每条规则项都具有相同的结构</p>
<h3 id="规则集字段的维度划分">规则集字段的维度划分</h3>
<p>如前文所述， 可以将规则集中的字段匹配方式分为精确匹配， 范围匹配， 前缀匹配三类， 精确匹配的代表字段有协议类型（TCP/UDP） ， 对于像端口号类型字段的匹配则采用范围匹配的方式， 而例如 IP 字段的匹配则采用的是前缀匹配。</p>
<p><strong>由于不同匹配方式的特点不一样， 目前还没有一种统一的匹配方式来满足三种字段匹配方式的需求， 通常针对每种类型字段的特点， 设计不同的匹配算法来各自进行匹配。</strong> （<mark><strong>划重点：不同字段就得采用不同的查找方式</strong></mark>）本文在研究三种类型字段的特点后， 针对每种类型的字段各自提出了相应的匹配算法： 针对<strong>精确匹配字段</strong>， 设计一种可以均衡哈希冲突和哈希查找时间的基于位运算的哈希算法； 对于<strong>范围匹配字段</strong>， 利用了区间排序的思路对该类字段提出了聚类查找算法； 最后为<strong>前缀匹配字段建立了一颗前缀树</strong>， 通过宽度优先搜索的方式去掉不相关的树分支， 从而达到快速查找的目的， 下面将进行具体的介绍。</p>
<p>在包分类问题中， <strong>规则集中存在的字段大部分都是属于精确匹配字段</strong>， <strong>所采用的查找算法几乎都是利用哈希来设计的</strong>。 本文设计了一种可以均衡哈希冲突和哈希查找时间的哈希算法， 通过加入位运算的一些特性来减少哈希冲突的概率。</p>
<p>根据上文所述， <strong>在规则集中如源端口号， 目的端口号等字段的取值往往不是一个单一的数值， 基本上是以一个范围区间的形式来展现的</strong>， 针对此类字段我们需要设计相应的查找算法来进行范围匹配字段的查找， <strong>目前针对范围匹配字段的查找算法往往都归类到了前缀匹配字段查找算法中</strong>， 主要思路是根据范围区间构建一棵类似前缀树的范围树来归类范围区间， 在查找的时候通过树结构查找特性快速的进行范围区间的定位， 从而查找到对应的规则集。 但此种<strong>根据范围树来设计的范围匹配字段查找算法的构建过程比较繁琐， 特别是范围区间之间交叠较多的时候， 构建的时间会显得比较长， 不利于快速的更新操作。</strong>（<mark><strong>划重点：缺点，有没有更好的解决方案</strong></mark>）</p>
<p>前缀匹配字段的查找算法目前比较主流的思路都是通过构建<strong>前缀查找树</strong>来设计的算法， 例如文献中所介绍的算法[50-51]。 此类基于<strong>前缀查找树的算法通常应用于 IP 查找</strong>中， 算法的主要思路在于像 IP 字段中会存在共同的前缀， 通过提取前缀构建查找树， 在查找匹配的过程中就可根据前缀范围快速的进行查找树减枝查找， 缩小查找范围， 加快查找速度。</p>
<p>本章介绍了<strong>一种基于维度分解的实时动态包分类算法</strong>，（<mark><strong>划重点：决策树和哈希表能够结合，那么决策树和维度降解，哈希表和维度降解能不能结合</strong></mark>） 其中基于维度分解的实时动态包分类算法分为了规则集的动态更新算法和字段的维度分解两部分， 对于字段的维度分解主要包括了三类字段各自的查找算法： 基于位运算的哈希算法、 基于二分查找的聚类查找算法、 基于前缀树的查找算法。</p>
<h3 id="异构平台编程模型-opencl">异构平台编程模型-OpenCL</h3>
<p>在目前的计算机架构体系下， 现行的处理器有 CPU， GPU 等， 而不同的处理器所涉及的应用场景不一样， 对于 CPU 来说， 需要处理多条指令和多条数据，属于典型的多指令多数据（Mutiple Instruction Mutiple Data， MIMD） 处理单元。而对于 GPU 来讲， 只需要处理单条指令和多条数据即可满足需求， 属于典型的单指令多数据（Single Instruction Mutiple Data， SIMD） 处理单元。</p>
<p>通常来讲，GPU 是执行特定的任务种类的， 只需要由控制器编译一条指令， 然后通过广播的方式发送到每个处理单元上执行即可[40]。 然而对于 CPU 的设计来说， 要并发处理多条指令和多条数据， 其结构设计十分复杂， 包括很复杂的流水线结构， 不再是单个控制路径， 具有多个控制路径的同时预编译也变得很复杂[41]。 基于以上CPU 和 GPU 的设计理念来说， <strong>GPU 更加适合处理逻辑单一但数据量密集型的任务， 而 CPU 适合处理逻辑较复杂数据量较小的任务。</strong></p>
<p>由于不同类型的处理器的执行逻辑不一样， 要想结合不同类型的处理器的优点设计一些异构计算的平台， 还需要一个能够统筹不同类型处理器的一个框架，而恰恰 OpenCL 就是这样一个异构平台的框架， 最开始有苹果公司提出， 经过多年发展， 已经成为了异构平台的一个标准， 应用非常广泛。</p>
<h2 id="基于-fpga-的包分类算法的设计与实现">2015 基于 FPGA 的包分类算法的设计与实现</h2>
<p>综合比较 ， 区域分割算法相对适合 处理高速数据报文，典型的 区域分割算法有Hicuts算法和HyperCuts算法 ，是需要进行决策树的构造， 耗费大量时间。</p>
<p>表2-2各种算法性能比较 （33页）</p>
<h2 id="基于规则聚集特征的高速分类算法">2016 基于规则聚集特征的高速分类算法</h2>
<p>里面有分类方法，分成了四类（<strong>没看完，再看吧，现在不想看2022/11/06/15:34</strong>，原因实验室太压抑了，受不人这么多....</p>
<p>待看： 2016规则集聚类 2016GPU 2015openflow协议 2001高性能IP路由查找和分组分类技术的研究_郑凯 里面有详细分类</p>


  </article>
  <script async src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script>
  <div class="busuanzi center">
    page PV:&nbsp;<span id="busuanzi_value_page_pv"></span>&nbsp;・&nbsp;
    site PV:&nbsp;<span id="busuanzi_value_site_pv"></span>&nbsp;・&nbsp;
    site UV:&nbsp;<span id="busuanzi_value_site_uv"></span>
  </div>


    





    </div>
  </div>
  <footer class="page-footer"><div class="clearfix">
</div>
<div class="right-foot">
    <div class="firstrow">
        <a href="#top" target="_self">
        <svg class="i-caret-right" viewBox="0 0 32 32" width="24" height="24" fill="none" stroke="currentcolor" stroke-linecap="round" stroke-linejoin="round" stroke-width="3">
            <path d="M10 30 L26 16 10 2 Z"></path>
        </svg>
        </a>
        © peirsist 2022
    </div>
    <div class="secondrow">
        <a target="_blank" rel="noopener" href="https://github.com/gaoryrt/hexo-theme-pln">
        Theme Pln
        </a>
    </div>
</div>
<div class="clearfix">
</div>
</footer>
  <script src="//cdn.bootcss.com/jquery/2.2.1/jquery.min.js"></script>
<script src="/js/search.min.js"></script>
<script type="text/javascript">

// disqus scripts


// dropdown scripts
$(".dropdown").click(function(event) {
  var current = $(this);
  event.stopPropagation();
  $(current).children(".dropdown-content")[($(current).children(".dropdown-content").hasClass("open"))?'removeClass':'addClass']("open")
});
$(document).click(function(){
    $(".dropdown-content").removeClass("open");
})

var path = "/search.xml";
searchFunc(path, 'local-search-input', 'local-search-result');

</script>

</body>
</html>
